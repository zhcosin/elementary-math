
\section{函数的凸性}

本文讨论上凸函数与下凸函数以及与之有关的不等式。

绝大多数函数的图像都不是一条笔直的直线，它们在某个区间上总是向上凸起或者向下凹陷。现在，我们要用数学语言来给函数的凸性下个定义：
\begin{definition}
 如果定义在区间$D$上的函数$f(x)$满足：对区间$D$上任意两个不相等的实数$a$、$b$都成立$f(\frac{a+b}{2}) \geqslant \frac{f(a)+f(b)}{2}$，则称函数$f(x)$在区间$D$上是上凸的。把这不等式中的不等号反向，则得到下凸函数的定义。如果这不等式中的等号不成立，则称为严格上凸或者严格下凸。
\end{definition}
这反映在图像就是：函数在某区间上上凸，则在它的图像上任意选择两个点，这两点之间的图像都将位于此两点连线的上方，下凸函数则相反。

下面是一些例子。

\begin{example}
  讨论下面这些函数的凸性。
  \begin{enumerate}
  \item $f(x)=x^n$($n$为正整数, $x>0$)
  \item $f(x)=\ln{x}$
  \item $f(x)=\sin{x}, 0 \leqslant x \leqslant \pi$
  \end{enumerate}
\end{example}

\begin{proof}[解]
因为对于整数$k(0 < k < n)$有$(a^n+b^n)-(a^{n-k}b^k+a^kb^{n-k})=(a^{n-k}-b^{n-k})(a^k-b^k)>0$，因此
\begin{equation}
  \begin{split}
\left( \frac{a+b}{2} \right)^n + \left( \frac{b+a}{2} \right)^n & = \frac{1}{2^n} \sum_{k=0}^nC_n^ka^{n-k}b^k + \frac{1}{2^n}\sum_{k=0}^nC_n^kb^{n-k}a^k \\
& = \frac{1}{2^n} \sum_{k=0}^n C_n^k \left( a^{n-k}b^k+a^kb^{n-k} \right) \\
& < \frac{1}{2^n} \sum_{k=0}^n C_n^k \left( a^n+b^n \right) \\
& = a^n+b^n
\end{split}
\end{equation}
所以$\frac{a^n+b^n}{2}>\left( \frac{a+b}{2} \right)^n$，函数$f(x)=x^n$在正实数区间上是下凸函数。

因为$\frac{a+b}{2}-\sqrt{ab}=\frac{1}{2}(\sqrt{a}-\sqrt{b})^2>0$，所以 $\ln{\frac{a+b}{2}}-\frac{\ln{a}+\ln{b}}{2}=\ln{\frac{a+b}{2}}-\ln{\sqrt{ab}}>0$，所以对数函数在正实数区间上是上凸函数。

因为$\frac{1}{2}(\sin{a}+\sin{b})=\sin{\frac{a+b}{2}}\cos{\frac{a-b}{2}} < \sin{\frac{a+b}{2}}$，所以正弦函数在区间$(0,\pi)$上是上凸函数。
\end{proof}

定义中是用任意两个数的中点来定义的，实际上这个权值可以推广到0到1之间的任意实数：
\begin{theorem}
  \label{theorem:convexity-function-with-weight}
  如果函数$f(x)$是定义在区间$D$上的上凸函数，并且在此区间上连续，则对于区间上任意两个实数$a$、$b$，以及任意两个满足$\alpha + \beta = 1(\alpha \geqslant 0, \beta \geqslant 0)$的实数$\alpha$、$\beta$，都成立不等式
  \begin{equation}
    \label{eq:convexity-function-with-weight}
    f(\alpha a + \beta b) \geqslant \alpha f(a) + \beta f(b) 
  \end{equation}
\end{theorem}

\begin{proof}[证明]
将不等式左边减去右边的差记为$g(\alpha)$，则只要证明$g(\alpha) \geqslant 0$对于一切$0 \leqslant \alpha \leqslant 1$恒成立即可。

  由于完整的证明需要用到高等数学中连续性的定义，所以这里仅就$\alpha$是有理数的情形进行证明(当然$\beta$也就同时为有理数)。

现在我们证明：对于任意正整数$n$，不等式$g(\frac{i}{n}) \geqslant 0 (i=0,1,\ldots,n)$都成立。

首先$g(0)=g(1)=0$，并且利用定义可以验证$g(\alpha)$仍是一个关于$\alpha$的上凸函数，因此
\begin{equation*}
  g(\frac{i}{n}) \geqslant \frac{1}{2} \left( g(\frac{i-1}{n}) + g(\frac{i+1}{n}) \right)
\end{equation*}
也即是
\begin{equation*}
  g(\frac{i+1}{n}) - g(\frac{i}{n}) \leqslant g(\frac{i}{n}) - g(\frac{i-1}{n})
\end{equation*}
令$\lambda_i = g(\frac{i+1}{n}) - g(\frac{i}{n})$，则有$\lambda_i \leqslant \lambda_{i-1}(i=1,2,\ldots,n-1)$，而
\begin{equation*}
 0 = g(1) - g(0) = \sum_{i=0}^{n-1} \left( g(\frac{i+1}{n}) - g(\frac{i}{n}) \right) 
\end{equation*}
即是$\sum_{i=0}^{n-1}\lambda_i=0$，因此存在正整数$k(0<k<n)$，使得
\begin{equation*}
\lambda_0 \geqslant \dots \geqslant \lambda_{k-1} \geqslant 0 \geqslant \lambda_k \geqslant \ldots \geqslant \lambda_{n-1}
\end{equation*}
也即是
\begin{equation*}
  0 = g(0) \leqslant g(\frac{1}{n}) \ldots \leqslant g(\frac{k}{n}) \geqslant \ldots \geqslant g(\frac{n-1}{n}) \geqslant g(1) = 0
\end{equation*}
因此，$g(\frac{i}{n})(i=0,1,\ldots,n)$均大于零，有理数的情形得证。
\end{proof}

现在来看一些例子，前面已经证明过对数函数在其定义域上是上凸函数，因此套用刚证明过的定理，就得到，对于任意正实数$a,b$以及满足$\alpha+\beta=1(\alpha>0,\beta>0)$的正实数$\alpha,\beta$，都成立不等式$\alpha a + \beta b \geqslant a^{\alpha}b^{\beta}$，而通常情况下的均值不等式$\frac{a+b}{2}\geqslant \sqrt{ab}$，则不过是其中$\alpha=\beta=\frac{1}{2}$的特殊情况而已。

借用数学归纳法，我们可以把定义中的两个数推广到多个数的情形：
\begin{theorem}
  \label{theorem:convexity-function-multile}
\emph{(琴生不等式)} 如果函数$f(x)$是区间$D$上的上凸函数，则对于此区间上的任意$n$个实数$x_i(i=1,2,\ldots,n)$，成立着不等式:
\begin{equation}
  \label{eq:convexity-function-multile}
  f(\frac{1}{n}\sum_{i=1}^nx_i) \geqslant \frac{1}{n}\sum_{i=1}^nf(x_i)
\end{equation}
\end{theorem}

\begin{proof}[证明]
  现在我们避开数学归纳法，借用刚才定理\ref{theorem:convexity-function-with-weight}来证明，但仅限于权重为有理数的情形（因为事实上我们只证明了这个情形）。

因为
\begin{equation*}
  \begin{split}
    & f \left ( \frac{1}{n}\sum_{i=1}^nx_i \right) \\
 = & f \left( (1-\frac{1}{n}) \frac{1}{n-1}\sum_{i=1}^{n-1}x_i + \frac{1}{n}x_n \right) \\
 \geqslant & (1-\frac{1}{n}) f \left( \frac{1}{n-1}\sum_{i=1}^{n-1}x_i \right) + \frac{1}{n} f(x_n)
  \end{split}
\end{equation*}
重复这个过程，就可以得到定理中的不等式。
\end{proof}

仍然以对数函数作为例子，套用上述结论，我们可以得出均值不等式的推广：
\begin{equation*}
\frac{1}{n}\sum_{i=1}^nx_i \geqslant \sqrt[n]{\prod_{i=1}^nx_i}
\end{equation*}

另一个例子，因为正弦函数在区间$(0,\pi)$上是上凸函数，所以对于一个三角形的三个内角，套用上述定理就有：
\begin{equation*}
\sin{A}+\sin{B}+\sin{C} \leqslant 3\sin{\frac{A+B+C}{3}} = \frac{3\sqrt{3}}{2}
\end{equation*}

同样的，我们还可以把定理\ref{theorem:convexity-function-with-weight}从两个数的情况推广到多个数的情形:
\begin{theorem}
 设函数$f(x)$在区间$D$上是上凸函数，那么对于该区间上任意$n$个实数$x_i(i=1,2,\ldots,n)$以及相应的权重$\alpha_i(\sum_{i=1}^n\alpha_i=1,\alpha_i \geqslant 0)$，有下面的不等式成立:
 \begin{equation}
   \label{eq:convexity-function-with-weight-multiple}
   f \left( \sum_{i=1}^n\alpha_i x_i \right) \geqslant \sum_{i=1}^n\alpha_i f(x_i)
 \end{equation}
\end{theorem}
其证明与定理\ref{theorem:convexity-function-multile}类似，此处从略。
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../book"
%%% End:
